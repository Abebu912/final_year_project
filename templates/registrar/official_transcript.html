{% extends 'base.html' %}
{% block title %}Official Transcript - {{ student.get_full_name }}{% endblock %}
{% block content %}
<div class="container py-4">
  <h2>Official Transcript</h2>
  <p><strong>{{ student.get_full_name }}</strong> â€¢ Student ID: {{ student.studentprofile.student_id }}</p>

  {% if transcripts_by_year %}
    {% for period, enrolls in transcripts_by_year.items %}
      <div class="card mb-3">
        <div class="card-header"><strong>{{ period }}</strong></div>
        <div class="card-body">
          <table class="table">
            <thead>
            <tr>
              <th>Subject</th>
              <th class="text-center">Result (out of 100)</th>
            </tr>
            </thead>
            <tbody>
              {% for e in enrolls %}
              <tr>
                <td>{{ e.subject.name }}</td>
                <td class="text-center">
                  {% if e.numeric_score is not None %}
                    {{ e.numeric_score|floatformat:0 }}
                  {% else %}
                    N/A
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>No transcript records available.</p>
  {% endif %}

  {% if transcripts_by_year %}
  <div class="card mt-3">
    <div class="card-body">
      <table class="table table-bordered">
        <tbody>
          <tr class="table-light">
            <th style="width: 200px;">Total Result</th>
            <td class="text-center">
              {% if total_result %}
                <strong>{{ total_result|floatformat:0 }}</strong>
              {% else %}
                N/A
              {% endif %}
            </td>
          </tr>
          <tr class="table-light">
            <th>Average Result</th>
            <td class="text-center">
              {% if numeric_average %}
                <strong>{{ numeric_average|floatformat:1 }} / 100</strong>
              {% else %}
                N/A
              {% endif %}
            </td>
          </tr>
          <tr class="table-light">
            <th>Class Rank</th>
            <td class="text-center">
              {% if student_rank %}
                <strong>#{{ student_rank }}</strong>
              {% else %}
                N/A
              {% endif %}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <div class="mt-3 d-flex gap-2 align-items-center">
    <a href="{% url 'student_academic_record' student.id %}" class="btn btn-secondary ms-auto">Back</a>
  </div>
</div>
{% endblock %}
